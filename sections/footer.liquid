<div class="footer_main-wrapper">
  <div id="w-node-_5eccf730-c887-5204-0e0c-693f99a73293-99a7328f" class="footer_link-grid">
    {% for link in linklists[section.settings.menu].links %}
      <div class="footer_link-column">
        <div class="titre-footer">{{ link.title }}</div>
        
        {% if link.links.size > 0 %}
          <div class="footer_link-list">
            {% for child_link in link.links %}
              <a href="{{ child_link.url }}" class="footer_link">{{ child_link.title }}</a>
            {% endfor %}
          </div>
        {% endif %}
      </div>
    {% endfor %}
  </div>
</div>

<!-- Section logo et informations en pleine largeur en dessous -->
<div class="footer_sub-footer">
  <a href="{{ routes.root_url }}" class="footer_logo-link w-inline-block">
    {% if section.settings.image_logo %}
      {{ section.settings.image_logo | image_url: width: 1000 | image_tag: loading: 'lazy', width: '182', class: 'footer_logo' }}
    {% else %}
      <img src="{{ 'Faroush-light-yellow.svg' | asset_url }}" loading="lazy" width="182" alt="" class="footer_logo">
    {% endif %}
  </a>
  
  {% if shop.enabled_payment_types.size > 0 %}
    <div class="footer_icon-block">
      <div class="text-size-regular footer">
        {{ section.settings.text_payment_method }}
      </div>
      <ul role="list" class="footer_payment-list w-list-unstyled">
        {% for type in shop.enabled_payment_types %}
          <li class="footer_payment-item">
            <div class="footer_payment-svg">
              {{ type | payment_type_svg_tag: class: 'footer_payment-img icon--full-color' }}
            </div>
          </li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}

  {% if localization.available_languages.size > 1 or localization.available_countries.size > 1 %}
    <div class="li-lang_wrapper">
      {% if localization.available_languages.size > 1 %}
        <localization-form class="li-lang_form-container">
          {% form 'localization', class: 'li-lang_form' %}
            <div data-hover="true" data-delay="500" class="li-lang_dropdown w-dropdown">
              <div lang="{{ localization.language.iso_code }}" class="li-lang_dd-toggle w-dropdown-toggle">
                <div>{{ localization.language.endonym_name | capitalize }}</div>
                <div class="li-lang_dd-toggle-icon w-embed">
                  <svg width="100%" height="100%" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path clip-rule="evenodd" d="M2.55806 6.29544C2.46043 6.19781 2.46043 6.03952 2.55806 5.94189L3.44195 5.058C3.53958 4.96037 3.69787 4.96037 3.7955 5.058L8.00001 9.26251L12.2045 5.058C12.3021 4.96037 12.4604 4.96037 12.5581 5.058L13.4419 5.94189C13.5396 6.03952 13.5396 6.19781 13.4419 6.29544L8.17678 11.5606C8.07915 11.6582 7.92086 11.6582 7.82323 11.5606L2.55806 6.29544Z" fill="currentColor"></path>
                  </svg>
                </div>
              </div>
              <nav class="li-lang_dd-list w-dropdown-list">
                {% for language in localization.available_languages %}
                  {% unless localization.language.iso_code == language.iso_code %}
                    <div class="li-lang_dd-list-item">
                      <a href="#" lang="{{ language.iso_code }}" hreflang="{{ language.iso_code }}" data-value="{{ language.iso_code }}" class="li-lang_dd-link w-dropdown-link">
                        {{ language.endonym_name | capitalize }}
                      </a>
                    </div>
                  {% endunless %}
                {% endfor %}
              </nav>
            </div>
            <input type="hidden" name="language_code" class="li-lang_hidden-input" value="{{ localization.language.iso_code }}">
          {% endform %}
        </localization-form>
      {% endif %}

      {% if localization.available_countries.size > 1 %}
        <localization-form class="li-currency_form-container">
          {% form 'localization', class: 'li-currency_form' %}
            <div data-hover="true" data-delay="500" class="li-currency_dropdown w-dropdown">
              <div class="li-currency_dd-toggle w-dropdown-toggle">
                <div>{{ localization.country.currency.iso_code }} {{ localization.country.currency.symbol }}</div>
                <div class="li-currency_dd-toggle-icon w-embed">
                  <svg width="100%" height="100%" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path clip-rule="evenodd" d="M13.4419 9.70456C13.5396 9.80219 13.5396 9.96048 13.4419 10.0581L12.5581 10.942C12.4604 11.0396 12.3021 11.0396 12.2045 10.942L8.00001 6.73749L3.7955 10.942C3.69787 11.0396 3.53958 11.0396 3.44195 10.942L2.55806 10.0581C2.46043 9.96048 2.46043 9.80219 2.55806 9.70456L7.82323 4.43939C7.92086 4.34176 8.07915 4.34176 8.17678 4.43939L13.4419 9.70456Z" fill="currentColor"></path>
                  </svg>
                </div>
              </div>
              <nav class="li-currency_dd-list w-dropdown-list">
                {% for country in localization.available_countries %}
                  {% unless localization.country.iso_code == country.iso_code %}
                    <div class="li-currency_dd-list-item">
                      <a href="#" data-value="{{ country.iso_code }}" class="li-currency_dd-link w-dropdown-link">
                        {{ country.currency.iso_code }} {{ country.currency.symbol }}
                      </a>
                    </div>
                  {% endunless %}
                {% endfor %}
              </nav>
            </div>
            <input type="hidden" name="country_code" class="li-currency_hidden-input" value="{{ localization.country.iso_code }}">
          {% endform %}
        </localization-form>
      {% endif %}
      
      <div class="li-lang_script w-embed w-script">
        <script>
          class LocalizationForm extends HTMLElement {
            constructor() {
              super();
              this.input = this.querySelector('input[name="language_code"], input[name="country_code"]');
              this.querySelectorAll('a').forEach(item =>
                item.addEventListener('click', this.onItemClick.bind(this))
              );
            }
            onItemClick(event) {
              event.preventDefault();
              const form = this.querySelector('form');
              this.input.value = event.currentTarget.dataset.value;
              if (form) form.submit();
            }
          }
          customElements.define('localization-form', LocalizationForm);
        </script>
      </div>
    </div>
  {% endif %}
</div>

{% schema %}
{
  "tag": "footer",
  "name": "footer",
  "class": "section_footer",
  "settings": [
    {
      "id": "image_logo",
      "type": "image_picker",
      "label": "Logo"
    },
    {
      "id": "text_payment_method",
      "type": "text",
      "label": "Payment Method",
      "default": "Payment Method"
    },
    {
      "type": "header",
      "content": "Navigation"
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Footer Menu",
      "default": "footer"
    }
  ],
  "presets": [
    {
      "name": "footer",
      "category": "Liquify",
      "blocks": []
    }
  ],
  "enabled_on": {
    "groups": ["*"]
  }
}
{% endschema %}

<style>
.section_footer {
  padding: 20px;
  font-family: 'Karla', sans-serif;
  color: #f5f2d9;
}

.footer_main-wrapper {
  margin-bottom: 50px;
}

.footer_link-grid {
  display: flex;
  justify-content: space-between;
  width: 100%;
}

/* Titres principaux (parents) */
.titre-footer {
  font-family: 'Karla', sans-serif;
  font-weight: bold;
  text-transform: uppercase;
  color: #f5f2d9;
}

/* Liens enfants */
.footer_link {
  font-family: 'Karla', sans-serif;
  font-weight: 500;
  color: #f5f2d9;
  text-decoration: none;
}

/* Footer sub-footer styles */
.footer_sub-footer,
.footer_sub-footer * {
  font-family: 'Karla', sans-serif;
  color: #f5f2d9;
}

.text-size-regular.footer {
  font-family: 'Karla', sans-serif;
  color: #f5f2d9;
}

/* Language and Currency switchers */
.li-lang_wrapper {
  display: flex;
  gap: 15px;
  align-items: center;
}

.li-lang_form-container,
.li-currency_form-container {
  position: relative;
}

/* Style identique pour les deux switchers */
.li-lang_dropdown,
.li-currency_dropdown {
  font-family: 'Karla', sans-serif;
  color: #f5f2d9;
}

.li-lang_dd-toggle,
.li-currency_dd-toggle {
  font-family: 'Karla', sans-serif;
  color: #f5f2d9;
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
}

.li-lang_dd-toggle-icon,
.li-currency_dd-toggle-icon {
  width: 12px;
  height: 12px;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: transform 0.2s ease;
}

.w-dropdown.w--open .li-currency_dd-toggle-icon {
  transform: rotate(180deg);
}

.li-lang_dd-list,
.li-currency_dd-list {
  font-family: 'Karla', sans-serif;
  position: absolute;
  bottom: 100%;
  left: 0;
  margin-bottom: 5px;
  background: rgba(0,0,0,0.8);
  border-radius: 4px;
  min-width: 120px;
  z-index: 1000;
}

.li-lang_dd-link,
.li-currency_dd-link {
  font-family: 'Karla', sans-serif;
  color: #f5f2d9;
  text-decoration: none;
  padding: 8px 12px;
  display: block;
}

.li-lang_dd-link:hover,
.li-currency_dd-link:hover {
  background: rgba(255,255,255,0.1);
}

@media (max-width: 767px) {
  .section_footer {
    padding: 20px 10px;
  }
  
  .footer_main-wrapper {
    margin-bottom: 20px;
  }
  
  .footer_link-grid {
    flex-direction: column;
    gap: 20px;
  }
}
</style>
