<div class="announcement-wrapper">
  <div id="w-node-_83d473b7-e557-566f-74be-ecc1a2818a2d-a2818a2b" class="w-layout-layout quick-stack wf-layout-layout">
    <div li-content-for-blocks="" class="w-layout-cell cell">
      {% for block in section.blocks %}
        {% case block.type %}
          {% when '@app' %}
            {% render block %}
          {% when 'social-media-icon' %}
            <div li-block="social-media-icon" class="lien-social-media-header">
              <a href="{{ block.settings.url_link }}" class="social-media-header w-inline-block">
                {% if block.settings.image_image %}
                  {{ block.settings.image_image | image_url: width: 1000 | image_tag: loading: 'lazy' }}
                {% else %}
                  <img src="{{ 'Social-Icon.svg' | asset_url }}" loading="lazy" alt="">
                {% endif %}
              </a>
            </div>
        {% endcase %}
      {% endfor %}
    </div>
    
    <div id="w-node-_83d473b7-e557-566f-74be-ecc1a2818a32-a2818a2b" class="w-layout-cell cell-2">
      <a href="{{ section.settings.url_link }}" class="w-inline-block">
        <div class="text-block">{{ section.settings.text_text }}</div>
      </a>
    </div>
    
    <div class="w-layout-cell cell-3">
      {% if localization.available_languages.size > 1 %}
        <div li-if="localization.available_languages.size > 1" class="language_component">
          {% form 'localization' %}
            <div data-delay="300" data-hover="true" class="langauge_dropdown w-dropdown">
              <div lang="{{ localization.language.iso_code}}" class="language_current-lang w-dropdown-toggle">
                <div li-object="localization.language.name" class="text-weight-semibold-2 is-in-switcher">{{ localization.language.name }}</div>
                {% if link.links.size > 0 %}
                  <div li-if="link.links.size > 0" class="language_icon w-embed">
                    <svg width=" 100%" height=" 100%" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path fill-rule="evenodd" clip-rule="evenodd" d="M2.55806 6.29544C2.46043 6.19781 2.46043 6.03952 2.55806 5.94189L3.44195 5.058C3.53958 4.96037 3.69787 4.96037 3.7955 5.058L8.00001 9.26251L12.2045 5.058C12.3021 4.96037 12.4604 4.96037 12.5581 5.058L13.4419 5.94189C13.5396 6.03952 13.5396 6.19781 13.4419 6.29544L8.17678 11.5606C8.07915 11.6582 7.92086 11.6582 7.82323 11.5606L2.55806 6.29544Z" fill="currentColor"></path>
                    </svg>
                  </div>
                {% endif %}
              </div>
              <nav li-for:inside="language in localization.available_languages" class="language_list w-dropdown-list">
                {% for language in localization.available_languages %}
                  {% unless localization.language.iso_code == language.iso_code %}
                    <div li-unless="localization.language.iso_code == language.iso_code">
                      <a href="#" li-object="language.name" lang="{{ language.iso_code }}" data-value="{{ language.iso_code }}" hreflang="{{ language.iso_code }}" class="language_link w-dropdown-link">{{ language.name }}</a>
                    </div>
                  {% endunless %}
                {% endfor %}
              </nav>
            </div>
            <input type="hidden" name="language_code" value="{{ localization.language.iso_code }}">
          {% endform %}
          <div class="hide-2 w-embed w-script">
            <script>
              document.querySelectorAll(".language_component").forEach((wrapper) => {
                const form = wrapper.querySelector("form");
                const input = wrapper.querySelector("input[name='language_code']");
                if (form && input) {
                  form.querySelectorAll("a").forEach((link) => {
                    link.addEventListener("click", (event) => {
                      input.value = event.currentTarget.dataset.value;
                      form.submit();
                    });
                  });
                }
              });
            </script>
          </div>
        </div>
      {% endif %}
    </div>
  </div>
</div>

<style>
  .announcement-wrapper {
    position: relative;
    z-index: 10;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-top: 10px;
  }
  
  /* Quick stack layout */
  .announcement-wrapper .quick-stack {
    width: 100%;
    padding: 0 20px;
  }
  
  /* Force l'affichage du texte central */
  .announcement-wrapper .text-block {
    color: #f5f2d9 !important;
    font-size: 14px;
    line-height: 1.2;
  }
  
  /* Alignement parfait des icônes sociales */
  .announcement-wrapper .lien-social-media-header {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 32px;
  }

  .announcement-wrapper .social-media-header {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    height: 32px;
    margin: 0 !important;
    padding: 0 !important;
  }

  .announcement-wrapper .social-media-header img {
    height: 18px !important;
    width: auto !important;
    object-fit: contain !important;
    vertical-align: middle !important;
    display: block !important;
    margin: 0 !important;
    padding: 0 !important;
  }
  
  /* Assurer que les cellules restent alignées */
  .announcement-wrapper .w-layout-cell {
    display: flex;
    align-items: center;
    height: 32px;
  }
  
  /* Cellule des icônes avec espacement */
  .announcement-wrapper .cell {
    display: flex !important;
    align-items: center !important;
    gap: 8px;
    height: 32px;
  }
  
  /* Cellule du texte central */
  .announcement-wrapper .cell-2 {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    height: 32px;
  }
  
  /* Pousser le sélecteur de langue à droite */
  .announcement-wrapper .cell-3 {
    margin-left: auto;
  }
  @media screen and (max-width: 767px) {
    .announcement-wrapper {
      margin-top: 0;
    }
    .announcement-wrapper .cell {
      display: none !important;
    }
    .announcement-wrapper .cell-3 {
      display: none !important;
    }
    .announcement-wrapper .cell-2 {
      display: flex !important;
      justify-content: center;
      width: 100%;
    }
  }
</style>

{% schema %}
{
  "tag": "header",
  "name": "Header Announcement",
  "class": "announcement-header",
  "blocks": [
    {
      "name": "social-media-icon",
      "type": "social-media-icon",
      "settings": [
        {
          "id": "url_link",
          "type": "url",
          "label": "Link"
        },
        {
          "id": "image_image",
          "type": "image_picker",
          "label": "Image"
        }
      ]
    },
    {
      "type": "@app"
    }
  ],
  "settings": [
    {
      "id": "url_link",
      "type": "url",
      "label": "Link"
    },
    {
      "id": "text_text",
      "type": "text",
      "label": "Text",
      "default": "10% offert sur votre prochaine commande"
    }
  ],
  "presets": [
    {
      "name": "Header Announcement",
      "category": "Header"
    }
  ]
}
{% endschema %}
